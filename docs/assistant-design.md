# تصميم المساعد الذكي Symbol AI - النسخة المحسنة

## تحليل المشكلة الحالية

المساعد الذكي يعطي إجابات غير دقيقة للأسباب التالية:

1. **LLM يختلق بيانات**: عندما لا توجد بيانات حقيقية، يقوم LLM بتخمين أو اختلاق أرقام
2. **عدم التحقق من البيانات**: الأدوات لا تتحقق بشكل صارم من وجود البيانات
3. **رسائل غامضة**: عندما لا توجد بيانات، الرسائل لا توضح ذلك بشكل صريح

## مبادئ التصميم الجديد

### 1. مبدأ الصدق المطلق
- **لا تختلق بيانات أبداً**
- إذا لم توجد بيانات، قل ذلك بوضوح
- اعرض فقط ما هو موجود فعلياً في قاعدة البيانات

### 2. مبدأ التحقق الصارم
- تحقق من وجود الموظف قبل أي عملية
- تحقق من وجود البيانات قبل عرض التقارير
- أعد رسالة واضحة إذا لم توجد بيانات

### 3. مبدأ الشفافية
- وضح مصدر البيانات دائماً
- اذكر الفترة الزمنية بدقة
- إذا كانت البيانات قديمة أو غير مكتملة، أوضح ذلك

## التحسينات المطلوبة

### تحسين System Prompt

```
**قواعد صارمة للمصداقية:**
- لا تختلق أي أرقام أو بيانات
- إذا أعادت الأداة "لا توجد بيانات"، قل ذلك بوضوح للموظف
- لا تخمن أو تقدر - اعتمد فقط على نتائج الأدوات
- إذا لم تجد بيانات لفترة معينة، اقترح فترة أخرى أو اسأل عن تفاصيل أكثر
```

### تحسين الأدوات

1. **get_report**: 
   - إرجاع رسالة واضحة عند عدم وجود بيانات
   - تضمين عدد السجلات الموجودة
   - توضيح الفترة الزمنية بدقة

2. **identify_employee**:
   - التحقق من الموظف المسجل دخوله (إذا كان مسجلاً)
   - عدم السماح بالتعرف على موظف آخر

3. **calculate_price**:
   - إرجاع قائمة الخدمات الموجودة فعلياً
   - توضيح الخدمات غير الموجودة

## هيكل الاستجابة المحسن

```typescript
interface ToolResult {
  success: boolean;
  hasData: boolean;        // هل توجد بيانات فعلية؟
  dataCount: number;       // عدد السجلات
  data?: any;
  error?: string;
  message: string;         // رسالة واضحة للمستخدم
  source?: string;         // مصدر البيانات
  period?: {               // الفترة الزمنية
    start: string;
    end: string;
  };
}
```

## خطة التنفيذ

1. تحديث system prompt بقواعد المصداقية
2. تحسين أداة get_report لتوضيح عدم وجود البيانات
3. إضافة حقل hasData لجميع الأدوات
4. تحسين رسائل الخطأ والتوضيح
5. اختبار مع سيناريوهات مختلفة
